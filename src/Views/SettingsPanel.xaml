<UserControl x:Class="Flow.Launcher.Plugin.AliasFlow.Views.SettingsPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="10"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header / Toolbar -->
        <DockPanel Grid.Row="0" LastChildFill="True">
            <StackPanel DockPanel.Dock="Left">
                <TextBlock FontSize="14" FontWeight="SemiBold" Text="Alias Flow" />
                <TextBlock Margin="0,3,0,0"
                           Opacity="0.8"
                           TextWrapping="Wrap"
                           Text="더블클릭(또는 Enter)로 수정. Delete로 삭제. JSON Import/Export로 백업/복원 가능합니다." />
            </StackPanel>

            <!-- Right Buttons -->
            <StackPanel DockPanel.Dock="Right"
                        Orientation="Horizontal"
                        HorizontalAlignment="Right">

                <!-- CRUD -->
                <Button Content="Add" MinWidth="72" Margin="0,0,6,0" Click="Add_Click"
                        ToolTip="새 항목 추가"/>
                <Button Content="Edit" MinWidth="72" Margin="0,0,6,0" Click="Edit_Click"
                        ToolTip="선택 항목 수정 (Enter/더블클릭)"/>
                <Button Content="Delete" MinWidth="72" Margin="0,0,12,0" Click="Delete_Click"
                        ToolTip="선택 항목 삭제 (Delete)"/>

                <!-- Backup -->
                <Button Content="Import JSON" MinWidth="96" Margin="0,0,6,0" Click="Import_Click"
                        ToolTip="JSON 파일에서 불러오기 (현재 목록을 교체)"/>
                <Button Content="Export JSON" MinWidth="96" Click="Export_Click"
                        ToolTip="현재 목록을 JSON으로 내보내기 (UTF-8, 한글 유지)"/>
            </StackPanel>
        </DockPanel>

        <!-- List -->
        <Border Grid.Row="2" BorderBrush="#33000000" BorderThickness="1" CornerRadius="6">
            <ListView x:Name="ItemsList"
                      ItemsSource="{Binding Items}"
                      SelectedItem="{Binding Selected, Mode=TwoWay}"
                      MouseDoubleClick="ItemsList_MouseDoubleClick"
                      KeyDown="ItemsList_KeyDown"
                      PreviewMouseWheel="ItemsList_PreviewMouseWheel"
                      ScrollViewer.CanContentScroll="True"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      ScrollViewer.VerticalScrollBarVisibility="Auto">

                <ListView.View>
                    <GridView AllowsColumnReorder="True">
                        <GridViewColumn Header="Title" Width="170" DisplayMemberBinding="{Binding Title}" />
                        <GridViewColumn Header="Description" Width="240" DisplayMemberBinding="{Binding Description}" />
                        <GridViewColumn Header="Target" Width="320" DisplayMemberBinding="{Binding Path}" />
                        <GridViewColumn Header="Hotkey" Width="170" DisplayMemberBinding="{Binding Hotkey}" />
                        <GridViewColumn Header="Keywords" Width="260" DisplayMemberBinding="{Binding KeywordsDisplay}" />
                    </GridView>
                </ListView.View>
            </ListView>
        </Border>

        <TextBlock Grid.Row="3"
                   Margin="2,8,2,0"
                   Opacity="0.7"
                   Text="Tip: Enter=Edit, Delete=Remove, Double-click=Edit"/>
    </Grid>
</UserControl>
